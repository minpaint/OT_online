{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}–ü—Ä–∏–µ–º –Ω–∞ —Ä–∞–±–æ—Ç—É: –ù–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫{% endblock %}

{% block extra_css %}
<style>
  /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã */
  .card-header h5 {
    font-weight: 600;
    margin-bottom: 0;
  }

  .form-section {
    margin-bottom: 25px;
  }

  .form-section h6 {
    border-bottom: 1px solid #e0e0e0;
    padding-bottom: 8px;
    margin-bottom: 15px;
    font-weight: 600;
    color: #505050;
  }

  .info-box {
    padding: 15px;
    border-radius: 5px;
    margin-top: 15px;
    margin-bottom: 15px;
  }

  .info-box-success {
    background-color: #d4edda;
    border: 1px solid #c3e6cb;
    color: #155724;
  }

  .info-box-info {
    background-color: #d1ecf1;
    border: 1px solid #bee5eb;
    color: #0c5460;
  }

  .info-box-warning {
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    color: #856404;
  }

  .info-badge {
    display: inline-block;
    padding: 3px 8px;
    border-radius: 3px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-right: 5px;
    margin-bottom: 5px;
  }

  .badge-medical {
    background-color: #d1ecf1;
    color: #0c5460;
  }

  .badge-siz {
    background-color: #d4edda;
    color: #155724;
  }

  .steps-indicator {
    display: flex;
    padding: 0;
    margin: 0 0 20px 0;
    list-style: none;
  }

  .steps-indicator li {
    flex: 1;
    position: relative;
    text-align: center;
    padding-top: 25px;
  }

  .steps-indicator li::before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: #dee2e6;
    z-index: 1;
  }

  .steps-indicator li::after {
    content: '';
    position: absolute;
    top: 10px;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #dee2e6;
    z-index: 0;
  }

  .steps-indicator li:first-child::after {
    left: 50%;
    width: 50%;
  }

  .steps-indicator li:last-child::after {
    width: 50%;
  }

  .steps-indicator li.active::before {
    background-color: #007bff;
  }

  .steps-indicator li.completed::before {
    background-color: #28a745;
  }

  .steps-indicator li.active ~ li::after,
  .steps-indicator li::after {
    background-color: #dee2e6;
  }

  .steps-indicator li.completed::after {
    background-color: #28a745;
  }

  .step-info-btn {
    margin-top: 10px;
  }
</style>
{% endblock %}

{% block content %}
<div class="container">
  <h1 class="mb-4">–ü—Ä–∏–µ–º –Ω–∞ —Ä–∞–±–æ—Ç—É: –ù–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫</h1>

  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Å–Ω–æ–≤–Ω—ã—Ö —à–∞–≥–æ–≤ -->
  <div class="row mb-4">
    <div class="col-12">
      <ul class="steps-indicator">
        <li class="active">
          <div>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
        </li>
        <li>
          <div>–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
        </li>
        <li>
          <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
        </li>
      </ul>
    </div>
  </div>

  <div class="card">
    <div class="card-header bg-primary text-white">
      <h5>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ</h5>
    </div>
    <div class="card-body">
      <form id="hiring-form" method="post">
        {% csrf_token %}

        <!-- –ü–µ—Ä–≤–∞—è —Å–µ–∫—Ü–∏—è: –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
        <div class="form-section">
          <h6>üë§ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h6>
          <div class="row">
            <div class="col-md-8">
              <div class="form-group">
                <label for="id_full_name_nominative">–§–ò–û (–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂) <span class="text-danger">*</span></label>
                <input type="text" name="full_name_nominative" id="id_full_name_nominative" class="form-control" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" required>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="id_hiring_type">–í–∏–¥ –ø—Ä–∏—ë–º–∞ <span class="text-danger">*</span></label>
                <select name="hiring_type" id="id_hiring_type" class="form-control" required>
                  <option value="new" selected>–ù–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫</option>
                  <option value="rehire">–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø—Ä–∏–µ–º</option>
                  <option value="transfer">–ü–µ—Ä–µ–≤–æ–¥ –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</option>
                  <option value="replacement">–ó–∞–º–µ—â–µ–Ω–∏–µ</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- –í—Ç–æ—Ä–∞—è —Å–µ–∫—Ü–∏—è: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ -->
        <div class="form-section">
          <h6>üè¢ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h6>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <label for="id_organization">–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è <span class="text-danger">*</span></label>
                <select name="organization" id="id_organization" class="form-control select2" required data-placeholder="üè¢ –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é...">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é --</option>
                  <option value="1">–ó–ê–û "–°—Ç—Ä–æ–π–ö–æ–º–ø–ª–µ–∫—Å"</option>
                  <!-- –î—Ä—É–≥–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ -->
                </select>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="id_subdivision">–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</label>
                <select name="subdivision" id="id_subdivision" class="form-control select2" data-placeholder="üè≠ –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ...">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ --</option>
                  <!-- –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ AJAX -->
                </select>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="id_department">–û—Ç–¥–µ–ª</label>
                <select name="department" id="id_department" class="form-control select2" data-placeholder="üìÇ –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª...">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª --</option>
                  <!-- –û—Ç–¥–µ–ª—ã –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ AJAX -->
                </select>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <label for="id_position">–î–æ–ª–∂–Ω–æ—Å—Ç—å <span class="text-danger">*</span></label>
                <select name="position" id="id_position" class="form-control select2" required data-placeholder="üëî –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å...">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å --</option>
                  <!-- –î–æ–ª–∂–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ AJAX -->
                </select>
              </div>

              <!-- –ë–ª–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏) -->
              <div id="position-requirements" class="d-none">
                <div class="info-box info-box-info">
                  <h6 class="mb-2">–î–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è:</h6>
                  <div id="requirements-list">
                    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–º–µ–¥–æ—Å–º–æ—Ç—Ä, –°–ò–ó –∏ —Ç.–¥.) -->
                  </div>

                  <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π -->
                  <div class="mt-3" id="requirements-actions">
                    <a href="#" id="medical-info-btn" class="btn btn-sm btn-info d-none">
                      <i class="fas fa-hospital"></i> –ú–µ–¥–æ—Å–º–æ—Ç—Ä: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    </a>

                    <a href="#" id="siz-info-btn" class="btn btn-sm btn-success d-none">
                      <i class="fas fa-hard-hat"></i> –°–ò–ó: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –°–∫—Ä—ã—Ç–∞—è —Å–µ–∫—Ü–∏—è –¥–ª—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞ (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É) -->
        <div id="medical-section" class="form-section d-none">
          <h6>üè• –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞</h6>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="id_date_of_birth">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è <span class="text-danger">*</span></label>
                <input type="date" name="date_of_birth" id="id_date_of_birth" class="form-control">
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="id_place_of_residence">–ú–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è <span class="text-danger">*</span></label>
                <textarea name="place_of_residence" id="id_place_of_residence" rows="3" class="form-control" placeholder="–ü–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –º–µ—Å—Ç–∞ –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞"></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- –°–∫—Ä—ã—Ç–∞—è —Å–µ–∫—Ü–∏—è –¥–ª—è –°–ò–ó (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É) -->
        <div id="siz-section" class="form-section d-none">
          <h6>üõ°Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –°–ò–ó</h6>
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label for="id_height">–†–æ—Å—Ç</label>
                <select name="height" id="id_height" class="form-control">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ—Å—Ç --</option>
                  <option value="150">150 —Å–º</option>
                  <option value="155">155 —Å–º</option>
                  <option value="160">160 —Å–º</option>
                  <!-- –î—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–æ—Å—Ç–∞ -->
                </select>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="id_clothing_size">–†–∞–∑–º–µ—Ä –æ–¥–µ–∂–¥—ã</label>
                <select name="clothing_size" id="id_clothing_size" class="form-control">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä --</option>
                  <option value="46">46</option>
                  <option value="48">48</option>
                  <option value="50">50</option>
                  <!-- –î—Ä—É–≥–∏–µ —Ä–∞–∑–º–µ—Ä—ã –æ–¥–µ–∂–¥—ã -->
                </select>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="id_shoe_size">–†–∞–∑–º–µ—Ä –æ–±—É–≤–∏</label>
                <select name="shoe_size" id="id_shoe_size" class="form-control">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä --</option>
                  <option value="39">39</option>
                  <option value="40">40</option>
                  <option value="41">41</option>
                  <!-- –î—Ä—É–≥–∏–µ —Ä–∞–∑–º–µ—Ä—ã –æ–±—É–≤–∏ -->
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group mt-4 text-right">
          <a href="{% url 'directory:employees:employee_list' %}" class="btn btn-secondary mr-2">–û—Ç–º–µ–Ω–∞</a>
          <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–µ -->
<div class="modal fade" id="medicalInfoModal" tabindex="-1" role="dialog" aria-labelledby="medicalInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="medicalInfoModalLabel">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–µ</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-12">
            <h6>–ü–µ—Ä–µ—á–µ–Ω—å –≤—Ä–µ–¥–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ <span id="position-name-medical"></span>:</h6>
            <div id="medical-factors-list">
              <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –≤—Ä–µ–¥–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ -->
            </div>

            <h6 class="mt-3">–¢—Ä–µ–±—É–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h6>
            <ul>
              <li>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä</li>
              <li>–ú–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä</li>
            </ul>

            <div class="alert alert-info">
              <i class="fas fa-info-circle"></i> –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä.
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button type="button" class="btn btn-primary" id="addMedicalInfoBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –°–ò–ó -->
<div class="modal fade" id="sizInfoModal" tabindex="-1" role="dialog" aria-labelledby="sizInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="sizInfoModalLabel">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –°–ò–ó</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-12">
            <h6>–ü–µ—Ä–µ—á–µ–Ω—å –°–ò–ó –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ <span id="position-name-siz"></span>:</h6>
            <div id="siz-list">
              <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –°–ò–ó -->
            </div>

            <h6 class="mt-3">–¢—Ä–µ–±—É–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h6>
            <ul>
              <li>–†–æ—Å—Ç - –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–æ–¥–µ–∂–¥—ã</li>
              <li>–†–∞–∑–º–µ—Ä –æ–¥–µ–∂–¥—ã - –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–æ–¥–µ–∂–¥—ã</li>
              <li>–†–∞–∑–º–µ—Ä –æ–±—É–≤–∏ - –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–æ–±—É–≤–∏</li>
            </ul>

            <div class="alert alert-info">
              <i class="fas fa-info-circle"></i> –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —É—á–µ—Ç–∞ –≤—ã–¥–∞—á–∏ –°–ò–ó.
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button type="button" class="btn btn-primary" id="addSizInfoBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  $(document).ready(function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Select2
    $('.select2').select2({
      theme: 'bootstrap4',
      width: '100%'
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
    $('#id_organization').on('change', function() {
      var organizationId = $(this).val();
      if (organizationId) {
        // –û—á–∏—â–∞–µ–º –∑–∞–≤–∏—Å–∏–º—ã–µ –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
        $('#id_subdivision').empty().append('<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ --</option>');
        $('#id_department').empty().append('<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª --</option>');
        $('#id_position').empty().append('<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å --</option>');

        // –ó–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π
        $.getJSON('/directory/autocomplete/subdivision/?forward={"organization":"' + organizationId + '"}', function(data) {
          $.each(data.results, function(index, item) {
            $('#id_subdivision').append('<option value="' + item.id + '">' + item.text + '</option>');
          });
          $('#id_subdivision').trigger('change.select2');
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –±–µ–∑ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –æ—Ç–¥–µ–ª–∞
        updatePositionList(organizationId, null, null);
      }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
    $('#id_subdivision').on('change', function() {
      var subdivisionId = $(this).val();
      var organizationId = $('#id_organization').val();

      // –û—á–∏—â–∞–µ–º –∑–∞–≤–∏—Å–∏–º—ã–µ –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
      $('#id_department').empty().append('<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª --</option>');

      if (subdivisionId) {
        // –ó–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ—Ç–¥–µ–ª–æ–≤
        $.getJSON('/directory/autocomplete/department/?forward={"subdivision":"' + subdivisionId + '"}', function(data) {
          $.each(data.results, function(index, item) {
            $('#id_department').append('<option value="' + item.id + '">' + item.text + '</option>');
          });
          $('#id_department').trigger('change.select2');
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π —Å –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º, –Ω–æ –±–µ–∑ –æ—Ç–¥–µ–ª–∞
        updatePositionList(organizationId, subdivisionId, null);
      } else {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π —Ç–æ–ª—å–∫–æ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π
        updatePositionList(organizationId, null, null);
      }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –æ—Ç–¥–µ–ª–∞
    $('#id_department').on('change', function() {
      var departmentId = $(this).val();
      var subdivisionId = $('#id_subdivision').val();
      var organizationId = $('#id_organization').val();

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
      updatePositionList(organizationId, subdivisionId, departmentId);
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
    function updatePositionList(organizationId, subdivisionId, departmentId) {
      if (organizationId) {
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã forward –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞
        var forwardParams = {
          organization: organizationId
        };

        if (subdivisionId) {
          forwardParams.subdivision = subdivisionId;
        }

        if (departmentId) {
          forwardParams.department = departmentId;
        }

        // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
        $('#id_position').empty().append('<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å --</option>');

        // –ó–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
        $.getJSON('/directory/autocomplete/position/?forward=' + JSON.stringify(forwardParams), function(data) {
          $.each(data.results, function(index, item) {
            $('#id_position').append('<option value="' + item.id + '">' + item.text + '</option>');
          });
          $('#id_position').trigger('change.select2');
        });
      }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
    $('#id_position').on('change', function() {
      var positionId = $(this).val();

      // –°–∫—Ä—ã–≤–∞–µ–º –±–ª–æ–∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ —Å–µ–∫—Ü–∏–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
      $('#position-requirements').addClass('d-none');
      $('#medical-section').addClass('d-none');
      $('#siz-section').addClass('d-none');
      $('#medical-info-btn').addClass('d-none');
      $('#siz-info-btn').addClass('d-none');

      if (positionId) {
        // –ó–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
        $.getJSON('/directory/hiring/api/position/' + positionId + '/info/', function(data) {
          if (data.status === 'success') {
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
            $('#requirements-list').empty();

            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
            if (data.needs_medical || data.needs_siz) {
              $('#position-requirements').removeClass('d-none');

              // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –∫–Ω–æ–ø–∫–∏
              if (data.needs_medical) {
                $('#requirements-list').append('<span class="info-badge badge-medical"><i class="fas fa-hospital"></i> –ú–µ–¥–æ—Å–º–æ—Ç—Ä</span>');
                $('#medical-info-btn').removeClass('d-none');

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
                $('#position-name-medical').text(data.position_name);

                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–∫—Ç–æ—Ä—ã –¥–ª—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞
                $.getJSON('/directory/api/medical/position/' + positionId + '/norms/', function(medData) {
                  $('#medical-factors-list').empty();
                  if (medData.factors && medData.factors.length > 0) {
                    var factorsHtml = '<ul>';
                    $.each(medData.factors, function(index, factor) {
                      factorsHtml += '<li><strong>' + factor.short_name + '</strong> - ' + factor.full_name + '</li>';
                    });
                    factorsHtml += '</ul>';
                    $('#medical-factors-list').html(factorsHtml);
                  } else {
                    $('#medical-factors-list').html('<p>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Ä–µ–¥–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö.</p>');
                  }
                });
              }

              if (data.needs_siz) {
                $('#requirements-list').append('<span class="info-badge badge-siz"><i class="fas fa-hard-hat"></i> –°–ò–ó</span>');
                $('#siz-info-btn').removeClass('d-none');

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
                $('#position-name-siz').text(data.position_name);

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –°–ò–ó –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
                $.getJSON('/directory/api/positions/' + positionId + '/siz-norms/', function(sizData) {
                  $('#siz-list').empty();
                  if (sizData.base_norms && sizData.base_norms.length > 0) {
                    var sizHtml = '<ul>';
                    $.each(sizData.base_norms, function(index, norm) {
                      sizHtml += '<li><strong>' + norm.siz_name + '</strong> - ' + norm.classification +
                                 ' (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ' + norm.quantity + ' ' + norm.unit + ')</li>';
                    });
                    sizHtml += '</ul>';
                    $('#siz-list').html(sizHtml);
                  } else {
                    $('#siz-list').html('<p>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –°–ò–ó.</p>');
                  }
                });
              }
            } else {
              // –ï—Å–ª–∏ –Ω–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
              $('#position-requirements').addClass('d-none');
            }
          }
        });
      }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö
    $('#addMedicalInfoBtn').on('click', function() {
      $('#medicalInfoModal').modal('hide');
      $('#medical-section').removeClass('d-none');
      $('html, body').animate({
        scrollTop: $('#medical-section').offset().top - 100
      }, 500);
    });

    $('#addSizInfoBtn').on('click', function() {
      $('#sizInfoModal').modal('hide');
      $('#siz-section').removeClass('d-none');
      $('html, body').animate({
        scrollTop: $('#siz-section').offset().top - 100
      }, 500);
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    $('#medical-info-btn').on('click', function(e) {
      e.preventDefault();
      $('#medicalInfoModal').modal('show');
    });

    $('#siz-info-btn').on('click', function(e) {
      e.preventDefault();
      $('#sizInfoModal').modal('show');
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
    $('#hiring-form').on('submit', function(e) {
      var positionId = $('#id_position').val();
      var fullName = $('#id_full_name_nominative').val();
      var dateOfBirth = $('#id_date_of_birth').val();
      var placeOfResidence = $('#id_place_of_residence').val();

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –¥–ª—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞
      if ($('#medical-section').is(':visible') && (!dateOfBirth || !placeOfResidence)) {
        e.preventDefault();
        alert('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞ (–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è).');
        return false;
      }

      // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π

      return true;
    });
  });
</script>
{% endblock %}