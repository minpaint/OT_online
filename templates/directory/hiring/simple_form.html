{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<style>
  /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã */
  .card-header h5 {
    font-weight: 600;
    margin-bottom: 0;
  }
  
  .form-section {
    margin-bottom: 25px;
  }
  
  .form-section h6 { /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ–∫—Ü–∏–π —Ç–∏–ø–∞ "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ" */
    border-bottom: 1px solid #e0e0e0;
    padding-bottom: 8px;
    margin-bottom: 15px;
    font-weight: 600;
    color: #505050;
  }

  .info-box {
    padding: 15px;
    border-radius: 5px;
    margin-top: 15px;
    margin-bottom: 15px;
  }

  .info-box-success {
    background-color: #d4edda;
    border: 1px solid #c3e6cb;
    color: #155724;
  }

  .info-box-info {
    background-color: #d1ecf1;
    border: 1px solid #bee5eb;
    color: #0c5460;
  }

  .info-box-warning {
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    color: #856404;
  }

  .info-badge {
    display: inline-block;
    padding: 3px 8px;
    border-radius: 3px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-right: 5px;
    margin-bottom: 5px;
  }

  .badge-medical {
    background-color: #d1ecf1;
    color: #0c5460;
  }

  .badge-siz {
    background-color: #d4edda;
    color: #155724;
  }

  .steps-indicator {
    display: flex;
    padding: 0;
    margin: 0 0 20px 0;
    list-style: none;
  }

  .steps-indicator li {
    flex: 1;
    position: relative;
    text-align: center;
    padding-top: 25px;
  }

  .steps-indicator li::before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: #dee2e6;
    z-index: 1;
  }

  .steps-indicator li::after {
    content: '';
    position: absolute;
    top: 10px;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #dee2e6;
    z-index: 0;
  }

  .steps-indicator li:first-child::after {
    left: 50%;
    width: 50%;
  }

  .steps-indicator li:last-child::after {
    width: 50%;
  }

  .steps-indicator li.active::before {
    background-color: #007bff;
  }

  .steps-indicator li.completed::before {
    background-color: #28a745;
  }

  .steps-indicator li.completed + li::after {
    background-color: #28a745;
  }

  .steps-indicator li.completed::after {
      background-color: #28a745;
  }


  /* --- –ü–†–û–°–¢–´–ï –ò –≠–§–§–ï–ö–¢–ò–í–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø Select2 --- */

  /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
  .select2-container .select2-selection--single {
    height: 38px !important;
    border: 1px solid #ced4da !important;
    border-radius: 0.375rem !important;
  }

  /* –¶–ï–ù–¢–†–ò–†–û–í–ê–ù–ò–ï –¢–ï–ö–°–¢–ê - –ì–õ–ê–í–ù–û–ï –ü–†–ê–í–ò–õ–û */
  .select2-selection__rendered {
    line-height: 38px !important;
    padding-left: 12px !important;
    padding-right: 30px !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    font-size: 16px !important;
    color: #212529 !important;
  }

  /* –¶–ï–ù–¢–†–ò–†–û–í–ê–ù–ò–ï –ü–õ–ï–ô–°–•–û–õ–î–ï–†–ê - –ì–õ–ê–í–ù–û–ï –ü–†–ê–í–ò–õ–û */
  .select2-selection__placeholder {
    line-height: 38px !important;
    padding-left: 12px !important;
    padding-right: 30px !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    font-size: 16px !important;
    color: #6c757d !important;
  }

  .select2-container .select2-selection--single .select2-selection__arrow {
    height: 38px !important;
    right: 1px !important;
    width: 20px !important;
    top: 0 !important;
  }

  .select2-container .select2-selection--single .select2-selection__arrow b {
    border-color: #999 transparent transparent transparent !important;
    border-style: solid !important;
    border-width: 5px 4px 0 4px !important;
    position: absolute !important;
    top: 50% !important;
    margin-top: -2px !important;
    left: 50% !important;
    margin-left: -4px !important;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ–∫—É—Å–∞ - –∫–∞–∫ –≤ Bootstrap 5 */
  .select2-container--focus .select2-selection--single,
  .select2-container.select2-container--focus .select2-selection--single {
    border-color: #86b7fe !important;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
    outline: 0 !important;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
  .select2-dropdown {
    border: 1px solid #ced4da !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
    z-index: 9999 !important;
  }

  .select2-results__option {
    padding: 0.5rem 0.75rem !important;
    font-size: 1rem !important;
  }

  .select2-results__option--highlighted {
    background-color: #0d6efd !important;
    color: #fff !important;
  }

  .select2-results__option--selected {
    background-color: #f8f9fa !important;
    color: #212529 !important;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è "–∑–∞–≥—Ä—É–∑–∫–∞" */
  .select2-container--loading .select2-selection--single .select2-selection__rendered::after {
    content: "–ó–∞–≥—Ä—É–∑–∫–∞..." !important;
    color: #6c757d !important;
  }

  /* –£–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª–µ–π */
  .select2-hidden-accessible {
    display: none !important;
  }

  /* –î–ª—è —Ñ–æ—Ä–º—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ */
  #hiring-form .select2-container {
    width: 100% !important;
  }

  /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ */
  .bootstrap5-styled.select2-container .select2-selection--single {
    height: calc(1.5em + 0.75rem + 2px) !important;
    min-height: 38px !important;
    border: 1px solid #ced4da !important;
    border-radius: 0.375rem !important;
    font-size: 1rem !important;
  }

  .bootstrap5-styled.select2-container .select2-selection--single .select2-selection__rendered {
    line-height: 24px !important;
    padding: 6px 30px 6px 12px !important;
    color: #212529 !important;
    margin-top: 0 !important;
    vertical-align: middle !important;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ–∫—É—Å–∞ —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º */
  .bootstrap5-styled.select2-container--focus .select2-selection--single {
    border-color: #86b7fe !important;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
  }

  /* –ú–µ—Ç–∫–∏ (labels) –≤ —Ñ–æ—Ä–º–µ –±—É–¥—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã—Ä–æ–≤–Ω–µ–Ω—ã –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é */
  /* –ï—Å–ª–∏ –≥–¥–µ-—Ç–æ –Ω—É–∂–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã */
  #hiring-form .form-group > label {
    /* text-align: left; */ /* –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ Bootstrap, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å */
  }

  /* Fieldset –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ç.–¥.) - –µ—Å–ª–∏ –æ–Ω–∏ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –∫–∞–∫ legend */
  #hiring-form fieldset > legend {
    font-size: 1.25rem; /* –†–∞–∑–º–µ—Ä –∫–∞–∫ —É h5 Bootstrap */
    font-weight: 600;
    padding-bottom: .5rem;
    margin-bottom: 1rem;
    border-bottom: 1px solid #e0e0e0;
    width: 100%; /* –ß—Ç–æ–±—ã –ª–∏–Ω–∏—è –±—ã–ª–∞ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É */
  }

</style>
{% endblock %}

{% block content %}
<div class="container">
  <h1 class="mb-4">{{ title }}</h1>

  <div class="row mb-4">
    <div class="col-12">
      <ul class="steps-indicator">
        <li class="active">
          <div>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
        </li>
        <li>
          <div>–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
        </li>
        <li>
          <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
        </li>
      </ul>
    </div>
  </div>

  <div class="card">
    <div class="card-header bg-primary text-white">
      <h5>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ</h5>
    </div>
    <div class="card-body">
      {% crispy form %}
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
<div class="modal fade" id="medicalInfoModal" tabindex="-1" role="dialog" aria-labelledby="medicalInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="medicalInfoModalLabel">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–µ</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">√ó</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-12">
            <h6>–ü–µ—Ä–µ—á–µ–Ω—å –≤—Ä–µ–¥–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ <span id="position-name-medical"></span>:</h6>
            <div id="medical-factors-list"></div>
            <h6 class="mt-3">–¢—Ä–µ–±—É–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h6>
            <ul>
              <li>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä</li>
              <li>–ú–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä</li>
            </ul>
            <div class="alert alert-info">
              <i class="fas fa-info-circle"></i> –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä.
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button type="button" class="btn btn-primary" id="addMedicalInfoBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="sizInfoModal" tabindex="-1" role="dialog" aria-labelledby="sizInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="sizInfoModalLabel">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –°–ò–ó</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">√ó</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-12">
            <h6>–ü–µ—Ä–µ—á–µ–Ω—å –°–ò–ó –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ <span id="position-name-siz"></span>:</h6>
            <div id="siz-list"></div>
            <h6 class="mt-3">–¢—Ä–µ–±—É–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h6>
            <ul>
              <li>–†–æ—Å—Ç - –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–æ–¥–µ–∂–¥—ã</li>
              <li>–†–∞–∑–º–µ—Ä –æ–¥–µ–∂–¥—ã - –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–æ–¥–µ–∂–¥—ã</li>
              <li>–†–∞–∑–º–µ—Ä –æ–±—É–≤–∏ - –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–æ–±—É–≤–∏</li>
            </ul>
            <div class="alert alert-info">
              <i class="fas fa-info-circle"></i> –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —É—á–µ—Ç–∞ –≤—ã–¥–∞—á–∏ –°–ò–ó.
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button type="button" class="btn btn-primary" id="addSizInfoBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
  // –ü–æ–∑–≤–æ–ª—è–µ–º DAL —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å autocomplete –ø–æ–ª—è
  // –£–±–∏—Ä–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å DAL

  // –ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ DAL –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏
  setTimeout(function() {
    console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é DAL...');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—è Select2 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
    var select2Fields = $('.select2-hidden-accessible').length;
    console.log('–ù–∞–π–¥–µ–Ω–æ Select2 –ø–æ–ª–µ–π:', select2Fields);

    if (select2Fields > 0) {
      console.log('DAL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');

      // –ü—Ä–∏–º–µ–Ω—è–µ–º inline —Å—Ç–∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º
      $('.select2-selection__rendered, .select2-selection__placeholder').each(function() {
        $(this).css({
          'line-height': '38px',
          'padding-top': '0px',
          'padding-bottom': '0px',
          'padding-left': '12px',
          'padding-right': '30px',
          'font-size': '16px',
          'height': '38px',
          'display': 'block'
        });
        console.log('–ü—Ä–∏–º–µ–Ω–µ–Ω—ã inline —Å—Ç–∏–ª–∏ –∫:', this.className);
      });

      // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
      $('.select2-selection__placeholder').each(function() {
        var $this = $(this);
        if (!$this.text() || $this.text() === '' || $this.text() === '--------') {
          var $select = $this.closest('.select2-container').siblings('select');
          var placeholder = $select.attr('data-placeholder') || '–í—ã–±–µ—Ä–∏—Ç–µ...';
          $this.text(placeholder);
          console.log('–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä:', placeholder);
        }
      });

      // –¢–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º
      $('.select2-selection--single').each(function() {
        $(this).css({
          'height': '38px',
          'border': '1px solid #ced4da',
          'border-radius': '0.375rem'
        });
      });

      console.log('–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
    } else {
      console.log('DAL –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—ã—Ç–∞–µ–º—Å—è –µ—â–µ —Ä–∞–∑ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É...');
      setTimeout(arguments.callee, 1000);
    }
  }, 300);

  $('#id_position').on('change', function() {
    var positionId = $(this).val();
    $('#medical-section').addClass('d-none');
    $('#siz-section').addClass('d-none');

    if (positionId) {
      $.ajax({
        url: '/directory/hiring/api/position/' + positionId + '/requirements/',
        type: 'GET',
        dataType: 'json',
        success: function(data) {
          var positionName = data.position_name;

          if (data.needs_medical) {
            $('#position-name-medical').text(positionName);
            $('#medical-section').removeClass('d-none');
            $.getJSON('/directory/api/medical/position/' + positionId + '/norms/', function(medData) {
              $('#medical-factors-list').empty();
              if (medData.factors && medData.factors.length > 0) {
                var factorsHtml = '<ul>';
                $.each(medData.factors, function(index, factor) {
                  factorsHtml += '<li><strong>' + factor.short_name + '</strong> - ' + factor.full_name + '</li>';
                });
                factorsHtml += '</ul>';
                $('#medical-factors-list').html(factorsHtml);
              } else {
                $('#medical-factors-list').html('<p>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Ä–µ–¥–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö.</p>');
              }
            });
          }

          if (data.needs_siz) {
            $('#position-name-siz').text(positionName);
            $('#siz-section').removeClass('d-none');
            $.getJSON('/directory/api/positions/' + positionId + '/siz-norms/', function(sizData) {
              $('#siz-list').empty();
              if (sizData.base_norms && sizData.base_norms.length > 0) {
                var sizHtml = '<ul>';
                $.each(sizData.base_norms, function(index, norm) {
                  sizHtml += '<li><strong>' + norm.siz_name + '</strong> - ' + norm.classification +
                            ' (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ' + norm.quantity + ' ' + norm.unit + ')</li>';
                });
                sizHtml += '</ul>';
                $('#siz-list').html(sizHtml);
              } else {
                $('#siz-list').html('<p>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –°–ò–ó.</p>');
              }
            });
          }
        },
        error: function(xhr, status, error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏:', error);
        }
      });
    }
  });

  $('#addMedicalInfoBtn').on('click', function() {
    $('#medicalInfoModal').modal('hide');
    $('html, body').animate({
      scrollTop: $('#medical-section').offset().top - 100
    }, 500);
  });

  $('#addSizInfoBtn').on('click', function() {
    $('#sizInfoModal').modal('hide');
    $('html, body').animate({
      scrollTop: $('#siz-section').offset().top - 100
    }, 500);
  });

  $(document).on('click', '.show-medical-info', function(e) {
    e.preventDefault();
    if ($('#id_position').val()) {
        $('#medicalInfoModal').modal('show');
    } else {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å.');
    }
  });

  $(document).on('click', '.show-siz-info', function(e) {
    e.preventDefault();
     if ($('#id_position').val()) {
        $('#sizInfoModal').modal('show');
    } else {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å.');
    }
  });

  if ($('#id_position').val()) {
    $('#id_position').trigger('change');
  }
});
</script>
{% endblock %}