{% extends "base.html" %}
{% load static %}

{% block title %}üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –æ—Å–º–æ—Ç—Ä—ã{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row mb-3">
        <div class="col-md-12">
            <h2>üè• –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –æ—Å–º–æ—Ç—Ä–æ–≤</h2>
        </div>
    </div>

    <!-- –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ -->
    {% if overdue %}
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card border-danger">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">üö® –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –º–µ–¥–æ—Å–º–æ—Ç—Ä—ã ({{ overdue|length }})</h5>
                </div>
                <div class="card-body p-0">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                                <th>–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                                <th>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</th>
                                <th>–í—Ä–µ–¥–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä</th>
                                <th>–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Å–º–æ—Ç—Ä</th>
                                <th>–°–ª–µ–¥—É—é—â–∏–π –æ—Å–º–æ—Ç—Ä</th>
                                <th>–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ –¥–Ω–µ–π</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for exam in overdue %}
                            <tr>
                                <td><strong>{{ exam.employee.full_name_nominative }}</strong></td>
                                <td>{{ exam.employee.position.name|default:"-" }}</td>
                                <td>{{ exam.employee.organization.short_name_ru }}</td>
                                <td>{{ exam.harmful_factor.name }}</td>
                                <td>{{ exam.previous_date|date:"d.m.Y"|default:"-" }}</td>
                                <td>{{ exam.next_date|date:"d.m.Y" }}</td>
                                <td><span class="badge badge-danger">{{ exam.days_until_next|add:"-1"|stringformat:"d"|slice:"1:" }}</span></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ -->
    {% if upcoming %}
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card border-warning">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">‚ö†Ô∏è –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–µ–¥–æ—Å–º–æ—Ç—Ä—ã ({{ upcoming|length }})</h5>
                </div>
                <div class="card-body p-0">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                                <th>–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                                <th>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</th>
                                <th>–í—Ä–µ–¥–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä</th>
                                <th>–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Å–º–æ—Ç—Ä</th>
                                <th>–°–ª–µ–¥—É—é—â–∏–π –æ—Å–º–æ—Ç—Ä</th>
                                <th>–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for exam in upcoming %}
                            <tr>
                                <td><strong>{{ exam.employee.full_name_nominative }}</strong></td>
                                <td>{{ exam.employee.position.name|default:"-" }}</td>
                                <td>{{ exam.employee.organization.short_name_ru }}</td>
                                <td>{{ exam.harmful_factor.name }}</td>
                                <td>{{ exam.previous_date|date:"d.m.Y"|default:"-" }}</td>
                                <td>{{ exam.next_date|date:"d.m.Y" }}</td>
                                <td><span class="badge badge-warning">{{ exam.days_until_next }}</span></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ -->
    {% if normal %}
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">‚úÖ –ü–ª–∞–Ω–æ–≤—ã–µ –º–µ–¥–æ—Å–º–æ—Ç—Ä—ã ({{ normal|length }})</h5>
                </div>
                <div class="card-body p-0">
                    <table class="table table-striped table-hover mb-0">
                        <thead>
                            <tr>
                                <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                                <th>–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                                <th>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</th>
                                <th>–í—Ä–µ–¥–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä</th>
                                <th>–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Å–º–æ—Ç—Ä</th>
                                <th>–°–ª–µ–¥—É—é—â–∏–π –æ—Å–º–æ—Ç—Ä</th>
                                <th>–î–Ω–µ–π –¥–æ –æ—Å–º–æ—Ç—Ä–∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for exam in normal %}
                            <tr>
                                <td>{{ exam.employee.full_name_nominative }}</td>
                                <td>{{ exam.employee.position.name|default:"-" }}</td>
                                <td>{{ exam.employee.organization.short_name_ru }}</td>
                                <td>{{ exam.harmful_factor.name }}</td>
                                <td>{{ exam.previous_date|date:"d.m.Y"|default:"-" }}</td>
                                <td>{{ exam.next_date|date:"d.m.Y"|default:"-" }}</td>
                                <td>
                                    {% if exam.days_until_next is not None %}
                                        {{ exam.days_until_next }}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    {% if not examinations %}
    <div class="alert alert-info">
        –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –æ—Å–º–æ—Ç—Ä–∞—Ö.
    </div>
    {% endif %}
</div>
{% endblock %}
