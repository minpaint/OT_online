{% extends "base.html" %}
{% load static %}

{% block title %}‚öôÔ∏è –¢–û –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row mb-3">
        <div class="col-md-12">
            <h2>‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h2>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-12">
            <a href="{% url 'deadline_control:equipment:create' %}" class="btn btn-primary">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            </a>
        </div>
    </div>

    {% if equipment_list %}
    <div class="row">
        <div class="col-md-12">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                        <th>–ò–Ω–≤. ‚Ññ</th>
                        <th>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</th>
                        <th>–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</th>
                        <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –¢–û</th>
                        <th>–°–ª–µ–¥—É—é—â–µ–µ –¢–û</th>
                        <th>–î–Ω–µ–π –¥–æ –¢–û</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for equipment in equipment_list %}
                    <tr {% if equipment.days_until_maintenance < 0 %}class="table-danger"{% elif equipment.days_until_maintenance <= 7 %}class="table-warning"{% endif %}>
                        <td>
                            <a href="{% url 'deadline_control:equipment:detail' equipment.pk %}">
                                {{ equipment.equipment_name }}
                            </a>
                        </td>
                        <td>{{ equipment.inventory_number }}</td>
                        <td>{{ equipment.organization.short_name_ru }}</td>
                        <td>{{ equipment.subdivision.name|default:"-" }}</td>
                        <td>{{ equipment.last_maintenance_date|date:"d.m.Y"|default:"-" }}</td>
                        <td>{{ equipment.next_maintenance_date|date:"d.m.Y"|default:"-" }}</td>
                        <td>
                            {% if equipment.days_until_maintenance is not None %}
                                {{ equipment.days_until_maintenance }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td>
                            {% if equipment.days_until_maintenance < 0 %}
                                <span class="badge badge-danger">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</span>
                            {% elif equipment.days_until_maintenance <= 7 %}
                                <span class="badge badge-warning">–°–∫–æ—Ä–æ</span>
                            {% else %}
                                <span class="badge badge-success">OK</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'deadline_control:equipment:update' equipment.pk %}" class="btn btn-sm btn-info">‚úèÔ∏è</a>
                            <a href="{% url 'deadline_control:equipment:delete' equipment.pk %}" class="btn btn-sm btn-danger">üóëÔ∏è</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="alert alert-info">
        –ù–µ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. <a href="{% url 'deadline_control:equipment:create' %}">–î–æ–±–∞–≤–∏—Ç—å</a>
    </div>
    {% endif %}
</div>
{% endblock %}
