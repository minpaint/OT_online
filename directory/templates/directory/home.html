{% extends 'base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–Ω–µ—à–Ω–∏–π CSS —Ñ–∞–π–ª –¥–ª—è —Å—Ç–∏–ª–µ–π –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã -->
<link rel="stylesheet" href="{% static 'directory/css/frontend_tree_view.css' %}">
<style>
 /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ */
 #generateDocumentsBtn {
transition: all 0.3s ease;
}

#generateDocumentsBtn:hover {
transform: scale(1.05);
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ */
 @keyframes fadeIn {
from { opacity: 0; }
to { opacity: 1; }
}

#generateDocumentsBtn {
animation: fadeIn 0.3s ease-in-out;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ */
.candidate-row td {
background: #f0f2f8;
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
 @media (max-width: 768px) {
.actions-bar {
flex-wrap: wrap;
}

#generateDocumentsBtn {
margin-top: 0.5rem;
width: 100%;
}
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π */
.quick-actions-card {
margin-bottom: 1.5rem;
}

.quick-actions-card .card-header {
background-color: #007bff;
color: white;
font-weight: bold;
}

.quick-action-btn {
margin-bottom: 0.5rem;
transition: all 0.2s ease;
}

.quick-action-btn:hover {
transform: translateY(-2px);
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.wizard-btn {
background-color: #6f42c1;
border-color: #6f42c1;
}

.wizard-btn:hover {
background-color: #5a32a3;
border-color: #5a32a3;
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-0">

<!-- üìã –°–µ–∫—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π -->
<div class="card quick-actions-card">
    <div class="card-header">
        <h5><i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4 mb-2">
                <a href="{% url 'directory:employees:employee_hire' %}" class="btn btn-success btn-block quick-action-btn">
                    <i class="fas fa-user-plus"></i> –ü—Ä–∏–Ω—è—Ç—å –Ω–∞ —Ä–∞–±–æ—Ç—É (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞)
                </a>
            </div>
            <a href="{% url 'directory:hiring:simple_hiring' %}" class="btn wizard-btn text-white btn-block quick-action-btn">
    <i class="fas fa-magic"></i> –ü—Ä–∏–Ω—è—Ç—å –Ω–∞ —Ä–∞–±–æ—Ç—É
</a>
            </div>
            <div class="col-md-4 mb-2">
                <a href="{% url 'directory:hiring:hiring_list' %}" class="btn btn-info btn-block quick-action-btn">
                    <i class="fas fa-list"></i> –°–ø–∏—Å–æ–∫ –ø—Ä–∏–µ–º–æ–≤ –Ω–∞ —Ä–∞–±–æ—Ç—É
                </a>
            </div>
        </div>
    </div>
</div>

 <!-- üîç –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
 <div class="card mb-3">
 <div class="card-body">
 <form method="get" class="search-form">
 <div class="input-group">
 <input type="text" id="localSearchInput" class="form-control tree-search" placeholder="–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ..." value="">
 <div class="input-group-append">
 <button type="button" class="btn btn-primary" id="localSearchBtn">
 <i class="fas fa-search"></i> –ù–∞–π—Ç–∏
</button>
 <button type="button" class="btn btn-secondary" id="clearSearchBtn">
 <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
</button>
 </div>
 </div>
 <small class="form-text text-muted">–ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ç–µ–∫—É—â–∏–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º, –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É</small>
 </form>
 </div>
 </div>

 <!-- üéØ –ü–∞–Ω–µ–ª—å —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ -->
 <div class="actions-bar">
 <button id="btnExpandAll" class="btn btn-sm btn-outline-secondary me-2 expand-all">
 <i class="fas fa-expand-alt"></i> –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ
</button>
 <button id="btnCollapseAll" class="btn btn-sm btn-outline-secondary me-2 collapse-all">
 <i class="fas fa-compress-alt"></i> –°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ
</button>
 <div class="dropdown d-inline-block me-2">
 <button class="btn btn-primary btn-sm dropdown-toggle" type="button" id="actionsDropdown"
 data-bs-toggle="dropdown" aria-expanded="false" disabled>
 –î–µ–π—Å—Ç–≤–∏—è <span id="selectedCount" class="badge bg-light text-dark ms-1">0</span>
 </button>
 <ul class="dropdown-menu" aria-labelledby="actionsDropdown">
 <li><a class="dropdown-item" href="#" id="btnIssueCard">
 <i class="fas fa-id-card"></i> –ö–∞—Ä—Ç–æ—á–∫–∞ —É—á–µ—Ç–∞
</a></li>
 <li><a class="dropdown-item" href="#" id="btnIssueSIZ">
 <i class="fas fa-hard-hat"></i> –í—ã–¥–∞—Ç—å –°–ò–ó
</a></li>
 <!-- –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –ø—É–Ω–∫—Ç –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é -->
 <li><a class="dropdown-item" href="#" id="btnGenerateDocuments">
 <i class="fas fa-file-alt"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
</a></li>
 <li><hr class="dropdown-divider"></li>
 <li><a class="dropdown-item" href="#" id="btnEditEmployee">
 <i class="fas fa-user-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
</a></li>
 </ul>
 </div>

 <a href="{% url 'directory:employees:employee_hire' %}" class="btn btn-success btn-sm ms-auto">
 <i class="fas fa-user-plus"></i> –ü—Ä–∏–Ω—è—Ç—å –Ω–∞ —Ä–∞–±–æ—Ç—É
</a>

 <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ -->
 <button id="generateDocumentsBtn" class="btn btn-danger btn-sm ms-2" style="display: none;">
 <i class="fas fa-file-alt"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
</button>

 <div id="selectedCounter" class="select-count text-muted" style="display: none;">
 –í—ã–±—Ä–∞–Ω–æ: <span id="counterValue">0</span>
 </div>
 </div>

 <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è URL (–≤–º–µ—Å—Ç–æ Django-—Ç–µ–≥–æ–≤ –≤–Ω—É—Ç—Ä–∏ JS) -->
 <div hidden>
 <span data-siz-personal-card-url="{% url 'directory:siz:siz_personal_card' 0 %}"></span>
 <span data-siz-issue-url="{% url 'directory:siz:siz_issue_for_employee' 0 %}"></span>
 <span data-employee-update-url="{% url 'directory:employees:employee_update' 0 %}"></span>
 <!-- –î–æ–±–∞–≤–ª—è–µ–º URL –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ -->
 <span data-document-selection-url="{% url 'directory:documents:document_selection' 0 %}"></span>
 <!-- –î–æ–±–∞–≤–ª—è–µ–º URL –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤–æ–π —Ñ–æ—Ä–º—ã -->
 <span data-hiring-wizard-url="{% url 'directory:employees:employee_hire' %}"></span>
 </div>

 <!-- üìã –¢–∞–±–ª–∏—Ü–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
 <div class="table-responsive mt-2">
 <table class="tree-table table table-hover" id="employeeTree">
 <thead>
 <tr>
 <th style="width: 40px;">
 <input type="checkbox" class="custom-checkbox" id="select-all">
 </th>
 <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
 <th>–î–µ–π—Å—Ç–≤–∏—è</th>
 </tr>
 </thead>
 <tbody>
 {# ----- –ë–ª–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ ----- #}
 {% if candidate_employees %}
 <tr class="table-secondary">
 <td></td>
 <td colspan="2"><strong>–ö–∞–Ω–¥–∏–¥–∞—Ç—ã</strong></td>
 </tr>
 {% for employee in candidate_employees %}
 <tr class="tree-row candidate-row" data-level="0">
 <td>
 <input type="checkbox" class="custom-checkbox employee-checkbox"
 data-id="{{ employee.id }}" data-type="employee">
 </td>
 <td class="field-name">
 <span class="tree-icon">üìù</span>
 {{ employee.full_name_nominative }} - {{ employee.position.position_name }}
 </td>
 <td>
 <div class="btn-group btn-group-sm">
 <a href="{% url 'directory:employees:employee_update' employee.pk %}"
 class="btn btn-outline-primary"><i class="fas fa-edit"></i></a>
 <a href="{% url 'directory:siz:siz_personal_card' employee.id %}"
 class="btn btn-outline-info"><i class="fas fa-id-card"></i></a>
 <a href="{% url 'directory:siz:siz_issue_for_employee' employee.id %}"
 class="btn btn-outline-success"><i class="fas fa-hard-hat"></i></a>
 <a href="{% url 'directory:documents:document_selection' employee.id %}"
 class="btn btn-outline-danger"><i class="fas fa-file-alt"></i></a>
 </div>
 </td>
 </tr>
 {% endfor %}
 {% endif %}
 {# ----- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ ----- #}

 {% for organization in organizations %}
<!-- üè¢ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è -->
 <tr class="tree-row organization-row" data-level="0" data-node-id="org-{{ organization.id }}">
 <td>
 <!-- –£–±—Ä–∞–Ω —á–µ–∫–±–æ–∫—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ -->
 </td>
 <td class="field-name">
 <span class="tree-toggle" data-node="org-{{ organization.id }}">-</span>
 <span class="tree-icon">üè¢</span> <strong>{{ organization.short_name }}</strong>
 </td>
 <td></td>
 </tr>

 <!-- üë§ –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–±–µ–∑ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è) -->
 {% for employee in organization.employees %}
<tr class="tree-row" data-level="1" data-parent="org-{{ organization.id }}">
 <td>
 <input type="checkbox" class="custom-checkbox employee-checkbox"
 data-id="{{ employee.id }}" data-type="employee">
 </td>
 <td class="field-name">
 <div class="tree-level">
 <span class="tree-icon">üë§</span> {{ employee.full_name_nominative }} - {{ employee.position.position_name }}
</div>
 </td>
 <td>
 <div class="btn-group btn-group-sm">
 <a href="{% url 'directory:employees:employee_update' employee.pk %}"
 class="btn btn-outline-primary">
 <i class="fas fa-edit"></i>
 </a>
 <a href="{% url 'directory:siz:siz_personal_card' employee.id %}"
 class="btn btn-outline-info">
 <i class="fas fa-id-card"></i>
 </a>
 <a href="{% url 'directory:siz:siz_issue_for_employee' employee.id %}"
 class="btn btn-outline-success">
 <i class="fas fa-hard-hat"></i>
 </a>
 <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
 <a href="{% url 'directory:documents:document_selection' employee.id %}"
 class="btn btn-outline-danger">
 <i class="fas fa-file-alt"></i>
 </a>
 </div>
 </td>
 </tr>
 {% endfor %}

<!-- üè≠ –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è -->
 {% for subdivision in organization.subdivisions %}
<tr class="tree-row subdivision-row" data-level="1"
 data-parent="org-{{ organization.id }}"
 data-node-id="sub-{{ subdivision.id }}">
 <td>
 <!-- –£–±—Ä–∞–Ω —á–µ–∫–±–æ–∫—Å –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è -->
 </td>
 <td class="field-name">
 <div class="tree-level">
 <span class="tree-toggle" data-node="sub-{{ subdivision.id }}">-</span>
 <span class="tree-icon">üè≠</span> <strong>{{ subdivision.name }}</strong>
 </div>
 </td>
 <td></td>
 </tr>

 <!-- üë§ –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (–±–µ–∑ –æ—Ç–¥–µ–ª–∞) -->
 {% for employee in subdivision.employees %}
<tr class="tree-row" data-level="2" data-parent="sub-{{ subdivision.id }}">
 <td>
 <input type="checkbox" class="custom-checkbox employee-checkbox"
 data-id="{{ employee.id }}" data-type="employee">
 </td>
 <td class="field-name">
 <div class="tree-level tree-level-2">
 <span class="tree-icon">üë§</span> {{ employee.full_name_nominative }} - {{ employee.position.position_name }}
</div>
 </td>
 <td>
 <div class="btn-group btn-group-sm">
 <a href="{% url 'directory:employees:employee_update' employee.pk %}"
 class="btn btn-outline-primary">
 <i class="fas fa-edit"></i>
 </a>
 <a href="{% url 'directory:siz:siz_personal_card' employee.id %}"
 class="btn btn-outline-info">
 <i class="fas fa-id-card"></i>
 </a>
 <a href="{% url 'directory:siz:siz_issue_for_employee' employee.id %}"
 class="btn btn-outline-success">
 <i class="fas fa-hard-hat"></i>
 </a>
 <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
 <a href="{% url 'directory:documents:document_selection' employee.id %}"
 class="btn btn-outline-danger">
 <i class="fas fa-file-alt"></i>
 </a>
 </div>
 </td>
 </tr>
 {% endfor %}

<!-- üìÇ –û—Ç–¥–µ–ª—ã -->
 {% for department in subdivision.departments %}
<tr class="tree-row department-row" data-level="2"
 data-parent="sub-{{ subdivision.id }}"
 data-node-id="dept-{{ department.id }}">
 <td>
 <!-- –£–±—Ä–∞–Ω —á–µ–∫–±–æ–∫—Å –æ—Ç–¥–µ–ª–∞ -->
 </td>
 <td class="field-name">
 <div class="tree-level tree-level-2">
 <span class="tree-toggle" data-node="dept-{{ department.id }}">-</span>
 <span class="tree-icon">üìÇ</span> <strong>{{ department.name }}</strong>
 </div>
 </td>
 <td></td>
 </tr>

 <!-- üë§ –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –æ—Ç–¥–µ–ª–∞ -->
 {% for employee in department.employees %}
<tr class="tree-row" data-level="3" data-parent="dept-{{ department.id }}">
 <td>
 <input type="checkbox" class="custom-checkbox employee-checkbox"
 data-id="{{ employee.id }}" data-type="employee">
 </td>
 <td class="field-name">
 <div class="tree-level tree-level-3">
 <span class="tree-icon">üë§</span> {{ employee.full_name_nominative }} - {{ employee.position.position_name }}
</div>
 </td>
 <td>
 <div class="btn-group btn-group-sm">
 <a href="{% url 'directory:employees:employee_update' employee.pk %}"
 class="btn btn-outline-primary">
 <i class="fas fa-edit"></i>
 </a>
 <a href="{% url 'directory:siz:siz_personal_card' employee.id %}"
 class="btn btn-outline-info">
 <i class="fas fa-id-card"></i>
 </a>
 <a href="{% url 'directory:siz:siz_issue_for_employee' employee.id %}"
 class="btn btn-outline-success">
 <i class="fas fa-hard-hat"></i>
 </a>
 <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
 <a href="{% url 'directory:documents:document_selection' employee.id %}"
 class="btn btn-outline-danger">
 <i class="fas fa-file-alt"></i>
 </a>
 </div>
 </td>
 </tr>
 {% endfor %}
{% endfor %} <!-- –∫–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º -->
 {% endfor %} <!-- –∫–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞ –ø–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º -->
 {% endfor %} <!-- –∫–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º -->
 </tbody>
 </table>
 </div>

 <!-- üìÑ –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
 {% if is_paginated %}
<nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º" class="mt-3">
 <ul class="pagination">
 {% if organizations.has_previous %}
<li class="page-item">
 <a class="page-link" href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}" aria-label="–ü–µ—Ä–≤–∞—è">
 <span aria-hidden="true">&laquo;&laquo;</span>
 </a>
 </li>
 <li class="page-item">
 <a class="page-link" href="?page={{ organizations.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è">
 <span aria-hidden="true">&laquo;</span>
 </a>
 </li>
 {% else %}
<li class="page-item disabled">
 <span class="page-link">&laquo;&laquo;</span>
 </li>
 <li class="page-item disabled">
 <span class="page-link">&laquo;</span>
 </li>
 {% endif %}

{% for num in paginator.page_range %}
{% if organizations.number == num %}
<li class="page-item active">
 <span class="page-link">{{ num }}</span>
 </li>
 {% elif num > organizations.number|add:'-3' and num < organizations.number|add:'3' %}
<li class="page-item">
 <a class="page-link" href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}">{{ num }}</a>
 </li>
 {% endif %}
{% endfor %}

{% if organizations.has_next %}
<li class="page-item">
 <a class="page-link" href="?page={{ organizations.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" aria-label="–°–ª–µ–¥—É—é—â–∞—è">
 <span aria-hidden="true">&raquo;</span>
 </a>
 </li>
 <li class="page-item">
 <a class="page-link" href="?page={{ paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}" aria-label="–ü–æ—Å–ª–µ–¥–Ω—è—è">
 <span aria-hidden="true">&raquo;&raquo;</span>
 </a>
 </li>
 {% else %}
<li class="page-item disabled">
 <span class="page-link">&raquo;</span>
 </li>
 <li class="page-item disabled">
 <span class="page-link">&raquo;&raquo;</span>
 </li>
 {% endif %}
</ul>
 </nav>
 {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º JavaScript —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ä–µ–≤–æ–º -->
<script src="{% static 'directory/js/frontend_tree_view.js' %}"></script>
<script src="{% static 'directory/js/frontend_tree_search.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
// –ü–æ–ª—É—á–∞–µ–º URL –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
 const documentSelectionUrl = document.querySelector('[data-document-selection-url]').getAttribute('data-document-selection-url');
const sizPersonalCardUrl = document.querySelector('[data-siz-personal-card-url]').getAttribute('data-siz-personal-card-url');
const sizIssueUrl = document.querySelector('[data-siz-issue-url]').getAttribute('data-siz-issue-url');
const employeeUpdateUrl = document.querySelector('[data-employee-update-url]').getAttribute('data-employee-update-url');
const hiringWizardUrl = document.querySelector('[data-hiring-wizard-url]').getAttribute('data-hiring-wizard-url');

// –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
 const checkboxes = document.querySelectorAll('.employee-checkbox');
const selectAllCheckbox = document.getElementById('select-all');
const actionsDropdown = document.getElementById('actionsDropdown');
const generateDocumentsBtn = document.getElementById('generateDocumentsBtn');
const btnGenerateDocuments = document.getElementById('btnGenerateDocuments');
const btnIssueCard = document.getElementById('btnIssueCard');
const btnIssueSIZ = document.getElementById('btnIssueSIZ');
const btnEditEmployee = document.getElementById('btnEditEmployee');

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
 function updateButtonsState() {
const selectedEmployees = Array.from(document.querySelectorAll('.employee-checkbox:checked'));
const selectedCount = selectedEmployees.length;

// –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
 document.getElementById('selectedCount').textContent = selectedCount;
document.getElementById('counterValue').textContent = selectedCount;

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∏ —Å—á–µ—Ç—á–∏–∫–∏
 document.getElementById('selectedCounter').style.display = selectedCount > 0 ? 'inline-block' : 'none';
actionsDropdown.disabled = selectedCount === 0;
generateDocumentsBtn.style.display = selectedCount === 1 ? 'inline-block' : 'none';
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
 checkboxes.forEach(checkbox => {
checkbox.addEventListener('change', updateButtonsState);
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö/—Å–Ω—è—Ç–∏—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å–æ –≤—Å–µ—Ö
 if (selectAllCheckbox) {
selectAllCheckbox.addEventListener('change', function() {
const isChecked = this.checked;
checkboxes.forEach(checkbox => {
checkbox.checked = isChecked;
});
updateButtonsState();
});
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞)
 if (generateDocumentsBtn) {
generateDocumentsBtn.addEventListener('click', function() {
const selectedEmployee = document.querySelector('.employee-checkbox:checked');
if (selectedEmployee) {
const employeeId = selectedEmployee.dataset.id;
window.location.href = documentSelectionUrl.replace('0', employeeId);
}
});
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã"
 if (btnGenerateDocuments) {
btnGenerateDocuments.addEventListener('click', function(e) {
e.preventDefault();
const selectedEmployee = document.querySelector('.employee-checkbox:checked');
if (selectedEmployee) {
const employeeId = selectedEmployee.dataset.id;
window.location.href = documentSelectionUrl.replace('0', employeeId);
}
});
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é "–ö–∞—Ä—Ç–æ—á–∫–∞ —É—á–µ—Ç–∞"
 if (btnIssueCard) {
btnIssueCard.addEventListener('click', function(e) {
e.preventDefault();
const selectedEmployee = document.querySelector('.employee-checkbox:checked');
if (selectedEmployee) {
const employeeId = selectedEmployee.dataset.id;
window.location.href = sizPersonalCardUrl.replace('0', employeeId);
}
});
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é "–í—ã–¥–∞—Ç—å –°–ò–ó"
 if (btnIssueSIZ) {
btnIssueSIZ.addEventListener('click', function(e) {
e.preventDefault();
const selectedEmployee = document.querySelector('.employee-checkbox:checked');
if (selectedEmployee) {
const employeeId = selectedEmployee.dataset.id;
window.location.href = sizIssueUrl.replace('0', employeeId);
}
});
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
 if (btnEditEmployee) {
btnEditEmployee.addEventListener('click', function(e) {
e.preventDefault();
const selectedEmployee = document.querySelector('.employee-checkbox:checked');
if (selectedEmployee) {
const employeeId = selectedEmployee.dataset.id;
window.location.href = employeeUpdateUrl.replace('0', employeeId);
}
});
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
 updateButtonsState();
});
</script>
{% endblock %}