{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='directory' %}">Directory</a>
    &rsaquo; <a href="{% url 'admin:directory_equipment_changelist' %}">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</a>
    &rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div class="module">
    <h1>‚öôÔ∏è –ò–º–ø–æ—Ä—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h1>

    <div class="help" style="background-color: #fef3cd; padding: 15px; border-left: 4px solid #ffc107; margin: 20px 0;">
        <h3>‚ö†Ô∏è –í–∞–∂–Ω–æ!</h3>
        <ul>
            <li>–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ <strong>XLSX</strong> –∏–ª–∏ <strong>XLS</strong></li>
            <li>–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: <code>org_short_name_ru</code>, <code>equipment_name</code></li>
            <li>–ò–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–π –Ω–æ–º–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (8 —Ü–∏—Ñ—Ä) –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω</li>
            <li>–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¢–û —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ last_maintenance_date + maintenance_period_months</li>
            <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –æ—Ç–¥–µ–ª—ã</li>
            <li>–°—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (–ø–æ inventory_number) –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ</li>
        </ul>
    </div>

    <fieldset class="module aligned">
        <h2>üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel-—Ñ–∞–π–ª–∞ (7 —Å—Ç–æ–ª–±—Ü–æ–≤)</h2>

        <div style="padding: 15px;">
            <h3>–ü–æ–ª—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ (–≤ —Å—Ç—Ä–æ–≥–æ–º –ø–æ—Ä—è–¥–∫–µ):</h3>
            <ol>
                <li><code>org_short_name_ru</code> - –ö—Ä–∞—Ç–∫–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ <span style="color: red;">‚òÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, 1-—è –∫–æ–ª–æ–Ω–∫–∞</span></li>
                <li><code>subdivision_name</code> - –°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</li>
                <li><code>department_name</code> - –û—Ç–¥–µ–ª</li>
                <li><code>equipment_name</code> - –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è <span style="color: red;">‚òÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ</span></li>
                <li><code>inventory_number</code> - –ò–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–π –Ω–æ–º–µ—Ä (8 —Ü–∏—Ñ—Ä, –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –µ—Å–ª–∏ –ø—É—Å—Ç–æ)</li>
                <li><code>maintenance_period_months</code> - –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –¢–û (–º–µ—Å—è—Ü–µ–≤)</li>
                <li><code>last_maintenance_date</code> - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¢–û (–î–î.–ú–ú.–ì–ì–ì–ì)</li>
            </ol>

            <div class="help" style="background-color: #d1ecf1; padding: 10px; margin: 15px 0;">
                <strong>üí° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è:</strong>
                <ul>
                    <li><code>inventory_number</code> - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è 8-–∑–Ω–∞—á–Ω—ã–π –Ω–æ–º–µ—Ä (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω)</li>
                    <li><code>next_maintenance_date</code> - —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ last_maintenance_date + maintenance_period_months</li>
                    <li><code>maintenance_status</code> = 'operational' (–∏—Å–ø—Ä–∞–≤–Ω–æ)</li>
                </ul>
            </div>

            <h3 style="margin-top: 20px;">–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ Excel:</h3>
            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                <thead>
                    <tr style="background-color: #417690; color: white;">
                        <th style="border: 1px solid #ddd; padding: 8px;">org_short_name_ru</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">subdivision_name</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">department_name</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">equipment_name</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">inventory_number</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">maintenance_period_months</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">last_maintenance_date</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">–†–∏–ö</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–¶–µ—Ö ‚Ññ1</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–£—á–∞—Å—Ç–æ–∫ —Å–±–æ—Ä–∫–∏</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–¢–æ–∫–∞—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫ 16–ö20</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">00000001</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">12</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">15.01.2025</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">–†–∏–ö</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–¶–µ—Ö ‚Ññ2</td>
                        <td style="border: 1px solid #ddd; padding: 8px;"></td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–ö—Ä–∞–Ω-–±–∞–ª–∫–∞ 5—Ç</td>
                        <td style="border: 1px solid #ddd; padding: 8px;"></td>
                        <td style="border: 1px solid #ddd; padding: 8px;">6</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">01.03.2025</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </fieldset>

    <form method="post" enctype="multipart/form-data" style="margin-top: 20px;">
        {% csrf_token %}
        <fieldset class="module aligned">
            <h2>üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</h2>
            <div class="form-row">
                <div>
                    <label for="import_file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel (XLSX –∏–ª–∏ XLS):</label>
                    <input type="file" id="import_file" name="import_file" accept=".xlsx,.xls" required>
                </div>
            </div>
        </fieldset>

        <div class="submit-row">
            <input type="submit" value="üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–º–ø–æ—Ä—Ç–∞" class="default">
            <a href="{% url 'admin:directory_equipment_changelist' %}" class="button">–û—Ç–º–µ–Ω–∞</a>
        </div>
    </form>
</div>
{% endblock %}
