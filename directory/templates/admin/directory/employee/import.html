{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='directory' %}">Directory</a>
    &rsaquo; <a href="{% url 'admin:directory_employee_changelist' %}">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
    &rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div class="module">
    <h1>üë• –ò–º–ø–æ—Ä—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h1>

    <div class="help" style="background-color: #fef3cd; padding: 15px; border-left: 4px solid #ffc107; margin: 20px 0;">
        <h3>‚ö†Ô∏è –í–∞–∂–Ω–æ!</h3>
        <ul>
            <li>–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ <strong>XLSX</strong> –∏–ª–∏ <strong>XLS</strong></li>
            <li>–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: <code>hire_date</code>, <code>org_short_name_ru</code>, <code>position_name</code>, <code>full_name_nominative</code></li>
            <li>–§–ò–û –≤ –¥–∞—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ pymorphy2</li>
            <li>–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ: start_date=hire_date, contract_type='standard', status='active'</li>
            <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è, –æ—Ç–¥–µ–ª—ã –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏</li>
            <li>–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (–ø–æ –§–ò–û) –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã</li>
        </ul>
    </div>

    <fieldset class="module aligned">
        <h2>üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel-—Ñ–∞–π–ª–∞ (6 —Å—Ç–æ–ª–±—Ü–æ–≤)</h2>

        <div style="padding: 15px;">
            <h3>–ü–æ–ª—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ (–≤ —Å—Ç—Ä–æ–≥–æ–º –ø–æ—Ä—è–¥–∫–µ):</h3>
            <ol>
                <li><code>hire_date</code> - –î–∞—Ç–∞ –ø—Ä–∏–µ–º–∞ (–î–î.–ú–ú.–ì–ì–ì–ì) <span style="color: red;">‚òÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, 1-—è –∫–æ–ª–æ–Ω–∫–∞</span></li>
                <li><code>org_short_name_ru</code> - –ö—Ä–∞—Ç–∫–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ <span style="color: red;">‚òÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ</span></li>
                <li><code>subdivision_name</code> - –°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</li>
                <li><code>department_name</code> - –û—Ç–¥–µ–ª</li>
                <li><code>position_name</code> - –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ <span style="color: red;">‚òÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ</span></li>
                <li><code>full_name_nominative</code> - –§–ò–û (–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂) <span style="color: red;">‚òÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ</span></li>
            </ol>

            <div class="help" style="background-color: #d1ecf1; padding: 10px; margin: 15px 0;">
                <strong>üí° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è:</strong>
                <ul>
                    <li><code>full_name_dative</code> - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ full_name_nominative —á–µ—Ä–µ–∑ pymorphy2</li>
                    <li><code>start_date</code> = hire_date</li>
                    <li><code>contract_type</code> = 'standard' (—Ç—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä)</li>
                    <li><code>status</code> = 'active' (–æ—Ñ–æ—Ä–º–ª–µ–Ω)</li>
                </ul>
            </div>

            <h3 style="margin-top: 20px;">–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ Excel:</h3>
            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                <thead>
                    <tr style="background-color: #417690; color: white;">
                        <th style="border: 1px solid #ddd; padding: 8px;">hire_date</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">org_short_name_ru</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">subdivision_name</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">department_name</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">position_name</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">full_name_nominative</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">01.01.2024</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–†–∏–ö</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–¶–µ—Ö ‚Ññ1</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–£—á–∞—Å—Ç–æ–∫ —Å–±–æ—Ä–∫–∏</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–°–ª–µ—Å–∞—Ä—å</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </fieldset>

    <form method="post" enctype="multipart/form-data" style="margin-top: 20px;">
        {% csrf_token %}
        <fieldset class="module aligned">
            <h2>üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</h2>
            <div class="form-row">
                <div>
                    <label for="import_file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel (XLSX –∏–ª–∏ XLS):</label>
                    <input type="file" id="import_file" name="import_file" accept=".xlsx,.xls" required>
                </div>
            </div>
        </fieldset>

        <div class="submit-row">
            <input type="submit" value="üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–º–ø–æ—Ä—Ç–∞" class="default">
            <a href="{% url 'admin:directory_employee_changelist' %}" class="button">–û—Ç–º–µ–Ω–∞</a>
        </div>
    </form>
</div>
{% endblock %}